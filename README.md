Здесь финальный код проекта со всеми изменениями.
